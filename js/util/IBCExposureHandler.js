if(typeof IBCExposureHandler=="undefined"){IBCExposureHandler={}}(function(){MarketExposureObj={eventId:null,marketId:null,numberOfWinner:0,numberOfActiveRunners:0,marketExposure:0,betSelections:{}};SelectionExposureObj={minExposure:0,selectionWinPL:0,selectionLossPL:0};function c(){MarketExposureObj.eventId=null;MarketExposureObj.marketId=null;MarketExposureObj.numberOfWinner=0;MarketExposureObj.numberOfActiveRunners=0;MarketExposureObj.marketExposure=0;MarketExposureObj.betSelections={};SelectionExposureObj.minExposure=0;SelectionExposureObj.selectionWinPL=0;SelectionExposureObj.selectionLossPL=0}IBCExposureHandler.getMarketExposure=function(){return a(MarketExposureObj)};IBCExposureHandler.setMarketExposure=function(e){c();MarketExposureObj=a(e)};IBCExposureHandler.initMarketInfo=function(e,h,f,g){c();MarketExposureObj.eventId=e;MarketExposureObj.marketId=h;MarketExposureObj.numberOfWinner=f;MarketExposureObj.numberOfActiveRunners=g;if(f==1){MarketExposureObj.betSelections[0]=a(SelectionExposureObj)}};IBCExposureHandler.generatorBetTicketObj=function(i,l,h,f,e,g){var j=MathUtil.decimal.multiply(1,MathUtil.decimal.multiply(MathUtil.decimal.subtract(f,1),e));var k=MathUtil.decimal.multiply(-1,e);j=!g&&j>0?0:j;k=!g&&k>0?0:k;return{eventId:i,marketId:l,selectionId:h,selectionWinPL:j,selectionLossPL:k}};IBCExposureHandler.calculateExposure=function(e){if(!$j.isArray(e)){throw"betTickets must bet array type.[betTicketObj....]"}if(MarketExposureObj.numberOfWinner!=1){throw"not support multiple winner."}$j.each(e,function(f,g){d(g)})};function d(i){var g=i.selectionId;MarketExposureObj.betSelections[g]=MarketExposureObj.betSelections[g]||a(MarketExposureObj.betSelections[0]);var h=Object.keys(MarketExposureObj.betSelections).length-1;if(h>MarketExposureObj.numberOfActiveRunners){MarketExposureObj.numberOfActiveRunners=h}var f=h==MarketExposureObj.numberOfActiveRunners;var e=0;$j.each(MarketExposureObj.betSelections,function(l,j){var k=j.minExposure;if(g==l){k=MathUtil.decimal.add(k,i.selectionWinPL)}else{k=MathUtil.decimal.add(k,i.selectionLossPL)}j.minExposure=k;if(f&&l==0){return}e=b(e,k)});MarketExposureObj.marketExposure=e}function a(e){return JSON.parse(JSON.stringify(e))}function b(f,e){return f>e?e:f}})();