if(typeof(StreamingUtil)=="undefined"){StreamingUtil={}}(function(){var e="https://transitmediatv.com:1968/RACING1/index.m3u8";var c=5;var i=false;var a=null;StreamingUtil.getPlayUrlObjList=function(j){if(j=="IN"){return[StreamingCDNType.WangSu,StreamingCDNType.IN,StreamingCDNType.SG]}if(j=="BD"){return[StreamingCDNType.IN,StreamingCDNType.WangSu,StreamingCDNType.SG]}return[StreamingCDNType.WangSu,StreamingCDNType.SG,StreamingCDNType.IN]};StreamingUtil.getPlayUrl=function(l,k,j){if(EventType.HORSE_RACING.unique()==j){return e}return l.streamingCDNType.url+h(l,k)};StreamingUtil.initPlayerObj=function(q,o,m,n,j,p,l){if(o==null){o=""}var k={RegId:"Monitor",defaultMuted:false,maxChkBufferdTimes:10,maxChkReadyStateTimes:10,maxDelaySec:6,maxChkSeekTimes:6,maxChkCurrentTimes:4,errorCallBack:j};q.playerObj=new StreamPlayer(k,i);q.playerObj.sUID=l;q.playerObj.sChnnalName=o;q.streamingCDNType=d(q);q.url=q.streamingCDNType.url;q.channel=o;q.eventType=m;q.video=null;q.mute=true;q.playerObj.defaultMuted=true;q.playerObj.useNativeVolume=true;StreamingUtil.setPlayerMaxSeekSec(q);p()};StreamingUtil.setPlayerMaxSeekSec=function(j){if(EventType.HORSE_RACING.unique()==j.eventType){j.playerObj.maxSeekSec=30}else{j.playerObj.maxSeekSec=12}if(i){Trace.info("["+DateUtil.format(new Date(),"yyyy/MM/dd hh:mm:ss")+"] maxSeekSec: "+j.playerObj.maxSeekSec)}};StreamingUtil.setPlayerChannel=function(m,k,j,l){m.playerObj.Stop();if(k==""){return}m.streamingCDNType=d(m);m.url=StreamingUtil.getPlayUrl(m,k,j);m.sDomain=b(m,k);m.sUri=h(m,k);m.channel=k;m.eventType=j;m.playerObj.sChnnalName=k;l();if(!m.streamingCDNType.isGetToken){StreamingUtil.startPlayerStream(m);return}StreamingUtil.getToken(m,StreamingUtil.startPlayerStream)};function b(k,j){return new URL(k.url).hostname}function h(l,k){var j=l.streamingCDNType;if(StreamingCDNType.WangSu.name==j.name){return"/live/m"+k+"/playlist.m3u8"}return"/live/m"+k+".m3u8"}function d(j){return j.playUrlObjList[j.urlIndex]}StreamingUtil.startPlayerStream=function(m,j){try{if(i){Trace.info("["+DateUtil.format(new Date(),"yyyy/MM/dd hh:mm:ss")+"] streamingObj.url "+m.url)}var k=m.url;if(j!=null&&j.token!=null){k+=j.token}m.playerObj.InitConnect("video",k);StreamingUtil.doStreamA(m.url,m.channel,m.playerObj.sUID)}catch(l){Trace.printStackTrace(l)}};StreamingUtil.changeLine=function(k,j){k.urlIndex++;if(k.urlIndex>=k.playUrlObjList.length){k.urlIndex=0}if(i){Trace.info("["+DateUtil.format(new Date(),"yyyy/MM/dd hh:mm:ss")+"] change line "+(k.urlIndex>=k.playUrlObjList.length?1:(k.urlIndex+1)))}StreamingUtil.setPlayerChannel(k,k.channel,k.eventType,j)};StreamingUtil.stopVideo=function(k){if(!k.playerObj){return}k.channel="";try{k.playerObj.Stop();k.playerObj=null}catch(j){Trace.printStackTrace(j)}};StreamingUtil.mute=function(l,j){if(!l.playerObj){return}l.mute=j;try{if(j){l.playerObj.Mute();$j("#mute").attr("class","btn-volume_off")}else{l.playerObj.unMute();$j("#mute").attr("class","btn-volume_on")}}catch(k){Trace.printStackTrace(k)}};function f(j){return"m"+j+".m3u8"}StreamingUtil.doStreamA=function(j,l,k){try{if(a==null){a=new StreamA()}var n={project:"CRICKET",streamname:l,cdn:g(j),uid:k};a.send(n)}catch(m){Trace.log(m)}};function g(k){var j=k.substr(0,(k.lastIndexOf("/")+1));return j}StreamingUtil.getToken=function(k,j){$j.ajax({type:"POST",url:"/exchange/member/tokenService/getStreamingSecurityKey",data:{sDomain:k.sDomain,sUri:k.sUri,type:k.streamingCDNType.unique()},success:function(l){if(l==null){return}j(k,l)},error:function(n,l,m){Trace.log(n.status);Trace.log(m)}})}})();