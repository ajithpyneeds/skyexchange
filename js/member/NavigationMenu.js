var NavigationBar={};(function(){var a=[];NavigationBar.init=function(){a=[];var b=JsCache.get("#pathBackUl");b.find(":last-child").removeClass("path-last");b.find(".node").remove();b.find("li").addClass("path-last");var c=JsCache.get("#path-pop");c.find(".node").remove();c.hide();$j(document).click(function(){JsCache.get("#path-pop").hide()})};NavigationBar.togglePathPop=function(b){JsCache.get("#path-pop").toggle();b.stopPropagation()};NavigationBar.addNode=function(g){if("MARKET"==g.type){return}var h=(g.id+"").replace(".","_");var j=JsCache.get("#pathBackUl");if(j.find("#navi_"+h).length>0){return}a[a.length]=g.id;var k=[];var d=a.length;for(var e=0;e<d;e++){k[k.length]=a[e]}var n=EventType.getInstanceOf(k[0]);var m="#"+g.name.trim();if(g.type=="EVENT_TYPE"){if(g.isTodaysCard!=null&&g.isTodaysCard==1){m=PageConfig.sportsPath+"?eventType="+g.id+"&isTodaysCard=1"}else{if(g.id==EventType.HORSE_RACING.unique()){m=PageConfig.landingPath+"/member/horse-racing/#Today"}else{if(g.id==EventType.GREYHOUND_RACING.unique()){m=PageConfig.landingPath+"/member/greyhound-racing/#Today"}else{if(g.id==EventType.ELECTION.unique()||g.id==EventType.FANCYBET.unique()){}else{m=PageConfig.sportsPath+"?eventType="+g.id}}}}}else{if(g.type=="MARKET"){m=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+PageConfig.naviEventId+"&marketId="+g.id}}var c='<a href="'+m+'" id="navi_'+h+'" menuObjType="'+g.type+'" >'+g.name+"</a>";if(g.type=="EVENT"&&n.isRacingEvent()){c='<a style="cursor: default;" id="navi_'+h+'" menuObjType="'+g.type+'" >'+g.name+"</a>"}var f=function(o,i,l){return function(){if(l.type=="EVENT"){PageConfig.naviEventId=l.id;PageConfig.selectMarketId=null}else{if(l.type=="GROUP"){}}var q=[];for(var p=0;p<o.length;p++){q[p]=o[p]}JsCache.get("#path-pop").hide();NavigationBar.update(q);NavigationHandler.getMenu(q);if(l.type=="EVENT_TYPE"){if(l.id==EventType.ELECTION.unique()||l.id==EventType.FANCYBET.unique()){return}MemberPage.selectSport(l.id)}else{if(l.type=="MARKET"){location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+PageConfig.naviEventId+"&marketId="+l.id}}}}(k,k[0],g);j.find(":last-child").removeClass("path-last");j.append('<li class="path-last node">'+c+"</li>");if(g.type=="EVENT"&&n.isRacingEvent()){}else{j.find("#navi_"+h).click(f)}var b=JsCache.get("#path-pop");b.prepend('<li class="node">'+c+"</li>");if(g.type=="EVENT"&&n.isRacingEvent()){}else{b.find("#navi_"+h).click(f)}b.hide()};NavigationBar.update=function(e){var d=[];var g=JsCache.get("#pathBackUl");var j=JsCache.get("#path-pop");var b=g.find("a");for(var c=(e.length+1);c<b.length;c++){var h=$j(b[c]);d[d.length]=h.attr("id")}for(var c=0;c<d.length;c++){var f=d[c];g.find("#"+f).parent().remove();j.find("#"+f).parent().remove()}a=e;g.find("li").last().addClass("path-last")};NavigationBar.restoreFullBar=function(d,e){for(var c=0;c<d.length;c++){if(c==0){}else{var f=null;for(var b=0;b<e.children.length;b++){if(e.children[b].id==d[c]){f=e.children[b];break}}if(f!=null){e=f}}if(e.id==d[c]){NavigationBar.addNode(e)}}};NavigationBar.addTodaysCardNode=function(b){NavigationBar.init();var c=EventType.getInstanceOf(b);var d=null;if(c!=null&&EventType.HORSE_RACING.unique()==c.unique()){d={id:b,name:"Horse Racing - Today's Card",type:"EVENT_TYPE",isTodaysCard:1}}else{if(c!=null&&EventType.GREYHOUND_RACING.unique()==c.unique()){d={id:b,name:"Greyhounds Racing - Today's Card",type:"EVENT_TYPE",isTodaysCard:1}}}NavigationBar.addNode(d)}})();if(typeof(NavigationHandler)=="undefined"){NavigationHandler={}}(function(){NavigationHandler.navigationIds=[];NavigationHandler.menuCollectionEventIds=[];var d=[];NavigationHandler.init=function(){NavigationHandler.navigationIds=[];NavigationHandler.getMenu([])};NavigationHandler.getMenu=function(p,r,q,n,o){if(p!=null){p=JSON.parse("["+p+"]")}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryMenuPath,data:{navigationIds:p,isTodaysCard:q},success:function(s){try{if(s!=null){if(r!=null&&r==true){var t=JSON.parse(s.result);NavigationBar.restoreFullBar(p,t);if(q==1){NavigationBar.addTodaysCardNode(p[0])}}NavigationHandler.updateNaviMenu(s,p,q,n,o);NavigationHandler.navigationIds=p}}catch(u){Trace.printStackTrace(u)}finally{}},error:function(s){Trace.error(s)}})};NavigationHandler.getMenuCallBack=function(n,p,o){if(n!=null){n=JSON.parse("["+n+"]")}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryMenuPath,data:{navigationIds:n,isTodaysCard:p},success:function(q){try{if(o){o(q)}}catch(r){Trace.printStackTrace(r)}},error:function(s,q,r){Trace.log(s.status);Trace.log(r)}})};function e(q){var o=[];if(q!=null){if(q.length>0){for(var n in q){var p=q[n];o.push(p)}}}return o}NavigationHandler.updateNaviMenu=function(n,x,q,C,y){var L=JSON.parse(n.result);if(n.fcResult!=null&&n.fcResult.length>0){L=JSON.parse(n.fcResult)}if(x!=null){x=JSON.parse("["+x+"]")}var z=EventType.getInstanceOf(PageConfig.selectEventType);var D=L.isFcCombo;if(L.type=="EVENT_TYPE"){if(x==null){x=[];x.push(L.id)}if(D){L=L.children}else{L=NavigationHandler.naviMenuList(L,x)}}$j("#listBoard").find("[id^=naviMenu_]").remove();var o=[];var B=[];for(var v in L){var K=L[v];if("EVENT"==K.type){o.push(K.id)}else{if("MARKET"==K.type){B.push(K.id)}}}if(B.length>0&&z!=null&&z.isRacingEvent()){NavigationHandler.setTabMarket(L)}var J=null;var w=null;if(z!=null&&z.isRacingEvent()&&q==1&&"EVENT"==L[1].type&&C==null&&y==null){J=L[1]}if(B.length>0){k(x,B)}if(o.length>0){NavigationHandler.menuCollectionEventIds=o}else{NavigationHandler.menuCollectionEventIds=[]}var G=1;var A=$j("#listBoard");var p=1;for(var v in L){JsCache.get("#listBoardLoading").hide();var K=L[v];var r=K.type;if(PageConfig.isCheckBookMode){if(z!=null&&WebSiteType.getInstanceOf(PageConfig.webSiteType).isFancyFairGroup()&&z.isRacingEvent()){}else{var M=K.isBookMenu;if(("GROUP"==r||"EVENT"==r)&&!M){continue}}}if(K.competitionCloseSite!=null&&CompetitionUtils.isCloseSite(K.competitionCloseSite,PageConfig.webSiteType)){continue}if(MarketUtil.isCloseSite(K.closeSite,PageConfig.webSiteType)){continue}if(D){l(K,A,p);p++;continue}var t=JsCache.clone("#listBoardTemplate");var E=e(x);z=EventType.getInstanceOf(E[0]);if(K.id==EventType.POLITICS.unique()){continue}if(K.type=="MARKET"){t.find("#arrow").hide()}else{if(q==1&&K.type=="EVENT_TYPE"){}else{E.push(K.id)}if(K.isTodaysCard==1){t.find("#arrow").hide()}}var s=function(N,O,P){return function(){var S=P.isTodaysCard==null?0:1;if(S==1){if(P.type=="EVENT_TYPE"){PageConfig.selectEventType=O;var R=function(U){if(!U){return}var T=JSON.parse(U.result);var X=T[1];var W=X.id;var V=X.children[0];var Y=V.id;location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+W+"&marketId="+Y+"&isTodaysCard=1"};NavigationHandler.getMenuCallBack(N,S,R)}if(P.type=="EVENT"){PageConfig.naviEventId=P.id;NavigationHandler.clickOpenTodaysCardMarket(P.children);var Q=P.children[0];NavigationHandler.addSelectClass(Q.id);NavigationHandler.setTabMarket(P.children);NavigationHandler.updateTabMarket();location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+P.id+"&marketId="+Q.id+"&isTodaysCard="+S}}else{NavigationBar.addNode(P);if(P.type=="MARKET"){NavigationHandler.addSelectClass(P.id)}else{NavigationHandler.getMenu(N)}if(P.type=="EVENT"){PageConfig.naviEventId=P.id}if(P.type=="EVENT_TYPE"){if(P.id==EventType.HORSE_RACING.unique()){location.href=PageConfig.landingPath+"/member/horse-racing/#Today"}else{if(P.id==EventType.GREYHOUND_RACING.unique()){location.href=PageConfig.landingPath+"/member/greyhound-racing/#Today"}else{if(P.id==EventType.ELECTION.unique()||P.id==EventType.FANCYBET.unique()){PageConfig.selectEventType=O;return}}}MemberPage.selectSport(P.id)}else{if(P.type=="MARKET"){if(P.eventId!=null){location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+P.eventId+"&marketId="+P.id}else{location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+PageConfig.naviEventId+"&marketId="+P.id}}}}}}(E,E[0],K);t.attr("id",("naviMenu_"+K.id).replace(".","_"));t.attr("sortName",K.name);t.attr("marketType",K.marketType);t.attr("isTodaysCard",K.isTodaysCard==null?0:K.isTodaysCard);t.attr("todaysCardGroup",G);t.attr("title",K.name);t.find("#name").attr("type",K.type);t.find("#name").html(K.name);t.find("#name").click(s);if(K.type=="EVENT"&&K.isTodaysCard==1){t.attr("marketDateTime",K.marketDateTime);if((K.id==C||K.id==PageConfig.fcId)&&K.children!=null){for(var F=0;F<K.children.length;F++){var u=K.children[F];if(u.id==y){w=K}}}}if(K.type=="MARKET"&&K.id==PageConfig.selectMarketId){JsCache.get("#listBoard").find("li").find("#name").removeClass("select");t.find("#name").addClass("select")}if(K.type=="MARKET"){var I='<img class="icon-no_play" src="/images/transparent.gif" />';t.find("#name").html(I+" "+K.name);t.attr("marketDateTime",K.marketDateTime)}if(K.type!="MARKET"){var H=function(N,O){return function(){NavigationBar.addNode(O);NavigationHandler.getMenu(N);if(O.type=="EVENT_TYPE"){PageConfig.selectEventType=N[0]}if(O.type=="EVENT"){PageConfig.naviEventId=O.id}}}(E,K);t.find("#arrow").click(H);t.find("#arrow").attr("type",K.type)}JsCache.get("#listBoard").append(t.show());if(q==1){NavigationHandler.appendTodaysCardMarket(E,K,G);G++}}if(q!=1&&!D){NavigationHandler.sortMenuNode()}if(PageConfig.selectMarketId!=null){NavigationHandler.updateMenuMarketStatusTask.run();if(z!=null&&z.isRacingEvent()){NavigationHandler.updateTabMarket()}else{if(JsCache.get("#tabMarketList")!=null){JsCache.get("#tabMarketList").hide()}}}else{if(JsCache.get("#tabMarketList")!=null){JsCache.get("#tabMarketList").hide()}}if(z!=null&&z.isRacingEvent()){if(J!=null&&C==null&&y==null){NavigationHandler.selectFirstTodaysCardMarket(J)}else{if(J==null&&C!=null&&y!=null){NavigationHandler.selectTargetTodaysCardMarket(C,y,w)}}}};function l(t,n,q){if(t.children.length==0){return}var o=n.find("#listBoardTemplate").clone();var s=function(w){return function(){var y=$j("#listBoard");var z=w.children[0];var x=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+z.eventId+"&marketId="+z.id;if(z.marketType.indexOf("FORECAST")>-1){PageConfig.fcId=w.id.split(".")[0];x+="&fcId="+PageConfig.fcId}location.href=x}}(t);o.prop("id",("naviMenu_"+t.id).replace(".","_"));o.attr("fcGroup",q);o.attr("type",t.type);o.find("#name").html(t.name);o.find("#name").on("click",s);o.find("#arrow").hide();n.append(o.show());var p=false;var u=t.children;u.sort(NaviMenuUtil.sortFcMarket);for(var r in u){var v=t.children[r];if(v==null){continue}b(v,n,q,t.id);if(PageConfig.selectMarketId==v.id){p=true}}if(p){n.find("[id^=naviMenu_][fcGroup="+q+"]").show();NavigationHandler.setTabMarket(u);NavigationHandler.updateTabMarket()}}function b(r,q,p,n){var o=q.find("#listBoardTemplate").clone();var s=function(t){return function(){var v=$j("#listBoard");v.find("li").find("#name").removeClass("select");v.find("#naviMenu_"+t.id.replace(".","_")).find("#name").addClass("select");var u=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+t.eventId+"&marketId="+t.id;if(t.marketType.indexOf("FORECAST")>-1){PageConfig.fcId=n.split(".")[0];u+="&fcId="+PageConfig.fcId}location.href=u}}(r);o.prop("id",("naviMenu_"+r.id).replace(".","_"));o.attr("fcGroup",p);o.attr("type",r.type);o.find("#name").html(r.name);o.find("#name").on("click",s);o.find("#arrow").hide();if(PageConfig.selectMarketId==r.id){o.find("#name").addClass("select")}q.append(o)}function k(p,o){var n=p[p.length-1];if(n.length==0||n.toString().indexOf(".")>=0){return}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryMarketsWithoutSelectionPath,data:{eventId:n},success:function(t){try{var z=[];for(var u=0;u<t.markets.length;u++){var q=t.markets[u];var s=$j("#naviMenu_"+q.marketId.replace(".","_"));if(s.length>0){if(MarketUtil.isClosed(q.status)||MarketUtil.isCloseSite(q.closeSite,PageConfig.webSiteType)){s.remove();var x=s.attr("todaysCardGroup");NavigationHandler.removeMenuEventByTodaysCardGroup(t.eventId,x);var r=s.attr("fcGroup");NavigationHandler.removeMenuRaceByGroup(r)}}z.push(q.marketId)}for(var v in o){var y=o[v];var s=$j("#naviMenu_"+y.replace(".","_"));if(s.length>0){if(ArrayUtil.indexOf(z,y)==-1){s.remove();var x=s.attr("todaysCardGroup");NavigationHandler.removeMenuEventByTodaysCardGroup(t.eventId,x);var r=s.attr("fcGroup");NavigationHandler.removeMenuRaceByGroup(r)}}}}catch(w){Trace.printStackTrace(w)}},error:function(q){Trace.printStackTrace(q)}})}NavigationHandler.addSelectClass=function(n){JsCache.get("#listBoard").find("li").find("#name").removeClass("select");$j("#naviMenu_"+n.replace(".","_")).find("#name").addClass("select")};NavigationHandler.appendTodaysCardMarket=function(p,r,n){for(var o in r.children){var s=r.children[o];var q=JsCache.clone("#listBoardTemplate");q.find("#arrow").hide();q.attr("id",("naviMenu_"+s.id).replace(".","_"));q.attr("eventId",s.eventId==null?r.id:s.eventId);q.attr("marketId",s.id);q.attr("marketType",s.marketType);q.attr("name","todaysCardMarket");q.attr("todaysCardGroup",n);q.find("#name").html(s.name).click(function(t,u,w,v,x){return function(){NavigationBar.addNode(w);JsCache.get("#listBoard").find("li").find("#name").removeClass("select");$j("#naviMenu_"+w.id.replace(".","_")).find("#name").addClass("select");PageConfig.naviEventId=v;NavigationHandler.setTabMarket(x);NavigationHandler.updateTabMarket();if(w.eventId!=null){var y=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+w.eventId+"&marketId="+w.id+"&isTodaysCard=1";if(w.eventId!=v){y+="&fcId="+v}location.href=y}else{location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+v+"&marketId="+w.id+"&isTodaysCard=1"}}}(p,p[0],s,r.id,r.children)).attr("type",s.type);JsCache.get("#listBoard").append(q)}};NavigationHandler.clickOpenTodaysCardMarket=function(p){$j("#listBoard").find("[name=todaysCardMarket]").hide();for(var n in p){var q=p[n];var o=$j("#naviMenu_"+q.id.replace(".","_"));if(o!=null&&o.length>0){o.show()}}};NavigationHandler.selectFirstTodaysCardMarket=function(r){if(r==null||r.children==null||r.children.length==0){return}var q=r.id;var p=r.children[0];var s=p.id;if(location.href.indexOf("/member/horse-racing")>0){location.href=location.href.replace("/member/horse-racing","/member/#TodaysCard#"+EventType.HORSE_RACING.unique())}if(location.href.indexOf("/member/greyhound-racing")>0){location.href=location.href.replace("/member/greyhound-racing","/member/#TodaysCard#"+EventType.GREYHOUND_RACING.unique())}var o=$j("[id=naviMenu_"+s.replace(".","_")+"][eventId="+q+"]");if(o.length>0){NavigationHandler.addSelectClass(s);NavigationHandler.setTabMarket(r.children);NavigationHandler.updateTabMarket();location.href=PageConfig.fullMarketPath+"?eventType="+PageConfig.selectEventType+"&eventId="+q+"&marketId="+s+"&isTodaysCard=1";var n=o.attr("todaysCardGroup");if(!isNaN(n)){$j("[todaysCardGroup="+n+"]").show()}}else{MemberPage.view("marketClose")}};NavigationHandler.selectTargetTodaysCardMarket=function(p,r,q){var o=$j("[id=naviMenu_"+r.replace(".","_")+"][eventId="+p+"]");if(o.length>0){NavigationHandler.addSelectClass(r);NavigationHandler.setTabMarket(q.children);NavigationHandler.updateTabMarket();var n=o.attr("todaysCardGroup");if(!isNaN(n)){$j("[todaysCardGroup="+n+"]").show()}}else{MemberPage.view("marketClose")}};NavigationHandler.clickNextOpenRacingEvent=function(o,s,r){var q=$j("[id^=naviMenu_"+o+"]");for(var n=0;n<q.length;n++){var p=$j(q[n]);if(p.attr("isTodaysCard")==1&&p.attr("marketDateTime")==r){p.find("#name").click();break}}};NavigationHandler.getJustFullMarketEventHref=function(p,o){var q=[];var n=EventType.getInstanceOf(p);var r=function(t,u,s){return function(){j(t,u,s)}}(q[1].eventId,q[1].marketId,o);j(q[0].eventId,q[0].marketId,o,r)};function j(o,p,n,q){$j.ajax({type:"POST",dataType:"JSON",url:"/member/playerService/querySingleMarket",data:{eventId:o,marketId:p.trim()},success:function(r){try{if(r.eventId==null&&q!=null&&(typeof q==="function")){q.call()}var s="/member/#marketId#"+r.marketId+"#"+r.eventId;n.find("#name").attr("href",s)}catch(t){Trace.printStackTrace(t)}finally{}},error:function(r){Trace.printStackTrace(r)}})}NavigationHandler.naviMenuList=function(p,t){if(t.length==1){if(p==null){Trace.error(t);Trace.error(p)}return p.children}var r=null;var o=[];for(var n in t){o.push(t[n])}o=o.splice(1,t.length);for(var q in o){var s=o[q];if(q==0){r=h(s,p.children)}else{r=h(s,r.children)}}return r.children};function h(o,n){var q=null;for(var p in n){var r=n[p];if(r.id==o){q=r;break}}return q}NavigationHandler.getNavigationPathFully=function(n,o){$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryNavigationPathFullyPath,data:{eventType:n,pathId:o},success:function(p){try{NavigationHandler.navigationIds=p;var r=true;NavigationHandler.getMenu(NavigationHandler.navigationIds,r)}catch(q){Trace.printStackTrace(q)}finally{}},error:function(p){Trace.error(p)}})};NavigationHandler.sortMenuNode=function(){var n=JsCache.get("#listBoard").find("[id^=naviMenu_]");n.sort(function(q,o){var v=$j(q);var t=$j(o);var u=v.attr("sortName").trim();var r=t.attr("sortName").trim();var p=v.find("#name").attr("type");var s=t.find("#name").attr("type");return NaviMenuUtil.sortMenuNode(PageConfig.selectEventType,u,r,p,s,v.attr("isTodaysCard"),t.attr("isTodaysCard"),v.attr("marketDateTime"),t.attr("marketDateTime"),v.attr("marketType"),t.attr("marketType"))});JsCache.get("#listBoard").append(n)};NavigationHandler.updateMenuMarketStatusTask=TaskExecuter.createTask(5,0,function(){var n=this;a(n)});function a(n){if(PageConfig.selectMarketId==null){n.check();TaskExecuter.execute();return}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryMarketsWithoutSelectionPath,data:{eventType:PageConfig.selectEventType,eventId:PageConfig.selectEventId,},success:function(o){try{DataBase.markets.update(o.eventId,o.markets);m(o.markets,o.eventId)}catch(p){Trace.printStackTrace(p)}finally{n.check();TaskExecuter.execute()}},error:function(){n.check();TaskExecuter.execute()}})}function m(t,n){var o=null;for(var s in t){o=t[s];var q=$j("#naviMenu_"+o.marketId.replace(".","_"));if(q.length>0){if(MarketUtil.isClosed(o.status)){q.remove();var v=q.attr("todaysCardGroup");NavigationHandler.removeMenuEventByTodaysCardGroup(n,v);var p=q.attr("fcGroup");NavigationHandler.removeMenuRaceByGroup(p);continue}if(o.inPlay==1){var u=q.find("#name").find("img");u.removeClass("icon-no_play");u.addClass("icon-in_play")}else{var u=q.find("#name").find("img");u.removeClass("icon-in_play");u.addClass("icon-no_play")}}var r=$j("#tabMarket_"+o.marketId.replace(".","_"));if(r.length>0){if(MarketUtil.isClosed(o.status)){r.remove();continue}}}}NavigationHandler.removeMenuEventByTodaysCardGroup=function(o,n){if(!isNaN(n)){var q=$j("[todaysCardGroup="+n+"]");if(q!=null&&q.length>1){return}var p=$j("[id=naviMenu_"+o+"][todaysCardGroup="+n+"]");if(p!=null&&p.length>0){p.remove()}}};NavigationHandler.removeMenuRaceByGroup=function(q){if(!isNaN(q)){var p=$j("#listBoard");var o=p.find("[type=MARKET][fcGroup="+q+"]");if(o!=null&&o.length>0){return}var n=p.find("[type=RACE][fcGroup="+q+"]");if(n!=null&&n.length>0){n.remove()}}};NavigationHandler.updateMenuEventStatusTask=TaskExecuter.createTask(5,0,function(){var n=this;g(n)});function g(n){if(NavigationHandler.menuCollectionEventIds.length==0){n.check();TaskExecuter.execute();return}$j.ajax({type:"POST",dataType:"JSON",url:"/member/playerService/queryOpenMarketCountsByEventIds",data:{eventIds:NavigationHandler.menuCollectionEventIds},success:function(o){try{c(o.events)}catch(p){Trace.printStackTrace(p)}finally{n.check();TaskExecuter.execute()}},error:function(){n.check();TaskExecuter.execute()}})}function c(o){var q=null;for(var n in o){q=o[n];var p=$j("#naviMenu_"+q.eventId);if(p.length>0){if(q.openMarkets==0){p.remove();continue}}}}NavigationHandler.setTabMarket=function(n){d=n};NavigationHandler.updateTabMarket=function(){var p=JsCache.get("#tabMarketList");var q=i();if(q==null||q.marketDateTime==null){return}$j("[id^=tabMarket_]").remove();var o=f(q.marketDateTime);$j.each(o,function(r,u){var s=$j("#tabMarket_"+u.id.replace(".","_"));if(s.length==0){var t=u.name.slice(6,u.name.length);if(u.isTodaysCard!=null&&u.isTodaysCard==1){t=u.name}s=JsCache.clone("#tabMarketTemplate");s.attr("id","tabMarket_"+u.id.replace(".","_"));s.attr("sortName",t.toLowerCase());s.attr("sortType",u.marketType);s.attr("title",StringUtil.ucfirst(t));s.find("#tabName").html(StringUtil.ucfirst(t));if("WIN"==u.marketType&&u.name.indexOf("Win")<=0){s.find("#tabName").html(StringUtil.ucfirst(u.marketType))}if(u.isTodaysCard!=null&&u.isTodaysCard==1){s.attr("isTodaysCard",u.isTodaysCard)}s.find("#tabName").click(function(v){return function(){var w=$j("#naviMenu_"+v.id.replace(".","_"));if(w.length>0){w.find("#name").click()}}}(u));if(PageConfig.selectMarketId==u.id){s.find("#tabName").addClass("select")}}s.show();s.css("display","");p.append(s).show()});var n=p.find("[id^=tabMarket_]");n.sort(function(t,r){var x=$j(t);var v=$j(r);var y=x.attr("sortName").trim();var u=v.attr("sortName").trim();var s=x.attr("sortType").trim();var w=v.attr("sortType").trim();if(s=="WIN"){return -1}if(w=="WIN"){return 1}if(s=="PLACE"){return -1}if(w=="PLACE"){return 1}return y.localeCompare(u)});p.append(n);if(PageConfig.ENABLE_ONE_CLICK_BET=="true"){OneClickBetHandler.show()}};function i(){var n=null;$j.each(d,function(o,p){if(p.id==PageConfig.selectMarketId){n=p}});return n}function f(o){var n=[];$j.each(d,function(p,q){if(q.marketDateTime==o){n.push(q)}});return n}}());