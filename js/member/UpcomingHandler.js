if(typeof(UpcomingHandler)=="undefined"){UpcomingHandler={}}(function(){UpcomingHandler.queryTask=null;UpcomingHandler.init=function(){UpcomingHandler.queryTask=TaskExecuter.createTask(PageConfig.queryUpcomingHorseRaceCycleTime,0,function(){UpcomingHandler.queryUpcomingHorseRace(this)});UpcomingHandler.queryTask.run();TaskExecuter.execute();JsCache.get("#upcomingHorseRace").show()};UpcomingHandler.queryUpcomingHorseRace=function(a){UpcomingHandler.ajax(a)};UpcomingHandler.ajax=function(a){$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryUpcomingHorseRacePath,success:function(g){try{if(!g){return}$j("#nextHeader").nextAll().remove();$j("#upcomeHeader").nextAll().remove();var c=0;for(var d in g){if(EventUtils.isCloseSite(g[d].eventCloseSite,PageConfig.webSiteType)||MarketUtil.isCloseSite(g[d].marketCloseSite,PageConfig.webSiteType)){$j("#upcoming_"+g[d].marketId).remove();continue}var k=ElementPool.getUpcomingRaceTempLateElement();var b=$j(k).find("a");b.prop("id","upcoming_"+g[d].marketId);var j=function(e){return function(){location.href=PageConfig.fullMarketPath+"?eventType="+e.eventType+"&eventId="+e.eventId+"&marketId="+e.marketId}}(g[d]);$j(b).text(g[d].startTime+" "+g[d].raceName);$j(b).click(j);if(g[0].startTime==g[d].startTime&&c<3){var f=$j(k).find("span");$j(f).text(g[d].marketName);$j("#next").append(k);c++}else{$j("#upcoming").append(k)}}}catch(h){Trace.printStackTrace(h)}finally{a.check();TaskExecuter.execute()}},error:function(d,b,c){Trace.log(d.status);Trace.log(c)}})}})();if(typeof(ElementPool)=="undefined"){ElementPool={}}(function(){var a=new Array();ElementPool.getUpcomingRaceTempLateElement=function(){return DOMUtil.nextChildElement(DOMUtil.findById("upcomingRaceTempLate").cloneNode(true))}})();