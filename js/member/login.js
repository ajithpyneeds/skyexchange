if(typeof(LoginHandler)=="undefined"){LoginHandler={}}(function(){LoginHandler.init=function(){d();a();JsCache.get("#loginName").focus();PageConfig.fingerprint=(new TrafficStatistics()).get();PageConfig.fingerprint2="";(new TrafficStatistics2()).get(function(f){PageConfig.fingerprint2=f});PageConfig.fingerprintCanvas=(new TrafficStatistics({canvas:true})).get();PageConfig.fingerprintActiveX=(new TrafficStatistics({ie_activex:true})).get();PageConfig.fingerprintResolution=(new TrafficStatistics({screen_resolution:true})).get();LoginHandler.refreshImgTask.run();TaskExecuter.execute()};LoginHandler.hideUrgentNotice=function(){$j("#urgentNotice").hide()};LoginHandler.check=function(h){WindowEventUtil.stopEvent(h);PageConfig.loginName=$j("#loginName").val();PageConfig.password=$j("#password").val();PageConfig.validCode=$j("#validCode").val();PageConfig.valid=$j("#valid").val();PageConfig.tk=$j("#__tk").val();PageConfig.di=$j("#__di").val();PageConfig.detecasAnalysis=$j("#detecas-analysis").val();var f=true;var g="";if(PageConfig.validCode==null||PageConfig.validCode.length==0){f=false;g="msg.error.account.verifyCodeEmpty"}if(PageConfig.password==null||PageConfig.password.length==0){f=false;g="msg.error.account.passwordEmpty"}if(PageConfig.loginName==null||PageConfig.loginName.length==0){f=false;g="msg.error.account.accountEmpty"}if(f){LoginHandler.submit()}else{JsCache.get("#errorMsg").html(I18N.get(g)).show()}};LoginHandler.loginBoxCheck=function(h){WindowEventUtil.stopEvent(h);PageConfig.loginName=$j("#loginBoxLoginName").val();PageConfig.password=$j("#loginBoxPassword").val();PageConfig.validCode=$j("#loginBoxValidCode").val();PageConfig.valid=$j("#loginBoxValid").val();PageConfig.tk=$j("#__tk").val();PageConfig.di=$j("#__di").val();PageConfig.detecasAnalysis=$j("#detecas-analysis").val();var f=true;var g="";if(PageConfig.validCode==null||PageConfig.validCode.length==0){f=false;g="msg.error.account.verifyCodeEmpty"}if(PageConfig.password==null||PageConfig.password.length==0){f=false;g="msg.error.account.passwordEmpty"}if(PageConfig.loginName==null||PageConfig.loginName.length==0){f=false;g="msg.error.account.accountEmpty"}if(f){LoginHandler.submit()}else{$j("#loginBoxErrorMsg").html(I18N.get(g)).show()}};LoginHandler.submit=function(){$j.ajax({type:"POST",url:"/login/memberAuthController/login",data:{loginName:PageConfig.loginName,valid:PageConfig.valid,password:EncryptUtil.mask(EncryptUtil.mask(PageConfig.password)+PageConfig.valid),validCode:PageConfig.validCode,fingerprint:PageConfig.fingerprint,fingerprint2:PageConfig.fingerprint2,fingerprintCanvas:PageConfig.fingerprintCanvas,fingerprintActiveX:PageConfig.fingerprintActiveX,fingerprintResolution:PageConfig.fingerprintResolution,__tk:PageConfig.tk,__di:PageConfig.di,detecasAnalysis:PageConfig.detecasAnalysis},success:function(f){if(f&&f.error){if(f.new_valid){$j("#valid").val(f.new_valid);$j("#loginBoxValid").val(f.new_valid)}var i;if(f.error[0]=="["){i="";var g=JSON.parse(f.error);for(var h in g){i=g[h]}}else{i=f.error}JsCache.get("#errorMsg").html(i).show();$j("#loginBoxErrorMsg").html(i).show();LoginHandler.refreshImgTask.refresh();return}if(f.resetPW=="true"){window.location.replace("/login/members/passwordOnSignIn.jsp");return}var j=PageConfig.ENABLE_LOGIN_CHANGE_LINE?f.goTo:f.redirect;if(typeof(GoogleAnalyticsHandler)!="undefined"&&GoogleAnalyticsHandler.isEnable(PageConfig.webSiteType)){if(PageConfig.ENABLE_TERMS_CONDITIONS_PAGE&&j.indexOf("termsconditions.jsp")!=-1){}else{GoogleAnalyticsHandler.loginSuccess(PageConfig.loginName,PageConfig.webSiteType)}}if(!PageConfig.ENABLE_LOGIN_CHANGE_LINE){if(f.redirect){location.href=f.redirect}return}if(!f.z||!f.e){window.top.location=f.goTo;return}var l=window.location.hostname;if(l.indexOf("aws.")==0){window.top.location=f.goTo;return}PageConfig.goTo=f.goTo;PageConfig.z=f.z;PageConfig.e=f.e;PageConfig.eDefault=f.eDefault;PageConfig.port=f.port;for(var k=0;k<PageConfig.eDefault.length;k++){ImagePreload.loadImage(PageConfig.eDefault[k].host)}},error:function(h,f,g){Trace.log(h.status);Trace.log(g);LoginHandler.refreshImgTask.refresh();return}})};function d(){c("#loginBtn");JsCache.get("#authenticateImage").bind("click",function(){LoginHandler.refreshImgTask.refresh()})}function c(f){$j(document).off("keydown").on("keydown",function(g){if(KeyEventUtils.isEnterKey(g.keyCode)){$j(f).click()}})}function a(){$j("#loginBoxAuthenticateImage").on("click",function(){LoginHandler.refreshImgTask.refresh()})}LoginHandler.refreshImgTask=TaskExecuter.createTask(60,0,function(){var f=this;LoginHandler.refreshImg(f)});LoginHandler.refreshImg=function(f){if(f==null){return}reloadImg("authenticateImage");b();f.check();TaskExecuter.execute()};LoginHandler.userIsLogin=function(){if(!PageConfig.hasAccount){e();return false}return true};function e(){var f=$j("#loginBox");f.fadeIn();f.find("#loginBoxErrorMsg").html("");c("#loginBoxLoginBtn")}LoginHandler.hideLoginBox=function(){var f=$j("#loginBox");f.fadeOut();c("#loginBtn")};function b(){var f=document.getElementById("authenticateImage");var h=document.getElementById("loginBoxAuthenticateImage");if(h==null||h.length==0){return}try{h.src=f.src}catch(g){Trace.log(g)}}})();