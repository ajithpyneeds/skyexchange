if(typeof(FancyBetMultiMarketHandler)=="undefined"){FancyBetMultiMarketHandler={}}(function(){FancyBetMultiMarketHandler.queryTask=null;FancyBetMultiMarketHandler.init=function(){if(FancyBetMarketHandler.isEnableFancyBet()&&MultiMarketsHandler.isHasFancybetMultiMarket()){FancyBetMultiMarketHandler.initTask()}};FancyBetMultiMarketHandler.initTask=function(){if(FancyBetMultiMarketHandler.queryTask==null){var a=TaskExecuter.createTask(PageConfig.getFancyBetMarketsTaskCycleTime,0,function(){FancyBetMultiMarketHandler.queryFancyBetMultiMarkets(this)});a.version={};a.oddsSettingVersion={};FancyBetMultiMarketHandler.queryTask=a}else{FancyBetMultiMarketHandler.queryTask.isStop=false}FancyBetMultiMarketHandler.queryTask.run();TaskExecuter.execute()};FancyBetMultiMarketHandler.abortTask=function(){if(FancyBetMultiMarketHandler.queryTask!=null){FancyBetMultiMarketHandler.queryTask.stop()}};FancyBetMultiMarketHandler.queryFancyBetMultiMarkets=function(b){var g=DataBase.multiMarkets.queryAllByCategoryType(CategoryType.FANCY_BET.value);var d=[];for(var c=0;c<g.length;c++){var a=g[c];var f=a.eventId;if(typeof(b.version[f])=="undefined"){b.version[f]=-1}if(typeof(b.oddsSettingVersion[f])=="undefined"){b.oddsSettingVersion[f]=-1}var e={eventType:a.eventType,eventId:a.eventId,version:b.version[f],oddsSettingVersion:b.oddsSettingVersion[f]};d.push(e)}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.landingPath+"/member/playerService/queryFancyBetMultiMarkets",data:{marketPks:JSON.stringify(d)},success:function(j){try{if(!j){return}for(var k=0;k<j.fancyBets.length;k++){var h=j.fancyBets[k];var l=h.eventId;if(h.version>b.version[l]){b.version[l]=Math.max(h.version,b.version[l])}if(h.oddsSettingVersion>b.oddsSettingVersion[l]){b.oddsSettingVersion[l]=Math.max(h.oddsSettingVersion,b.oddsSettingVersion[l])}FancyBetMarketHandler.updateFancyBetMarkets(h)}}catch(m){Trace.printStackTrace(m)}finally{b.check();TaskExecuter.execute()}},error:function(j,h,i){Trace.log(j.status);Trace.log(i);b.check();TaskExecuterV2.execute()}})}})();