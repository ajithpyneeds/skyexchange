var HorseRacingPage={};(function(){HorseRacingPage.marketTs=-1;HorseRacingPage.tabChanged=false;HorseRacingPage.selectDayType="today";function a(d){var c=function(f){try{if(f.marketTs>HorseRacingPage.marketTs){HorseRacingPage.marketTs=f.marketTs}RacingSportUtil.initRenderRacing(f.events);if(JsCache.get("#contentBox").find("div").length==0){$j("#noDataDiv").show()}else{$j("#noDataDiv").hide()}}catch(g){Trace.printStackTrace(g)}finally{setTimeout(function(){JsCache.get("#loading").hide()},250)}};RacingSportUtil.initQueryRacingByDay(d,EventType.HORSE_RACING.value,c)}HorseRacingPage.init=function(){if(location.hash!="#Today"&&location.hash!="#Tomorrow"&&location.hash!="#AftTomorrow"){location.hash="#Today"}$j(window).bind("hashchange",function(){var c=location.hash;if(c==""){location.hash="#Today"}HorseRacingPage.route(c)});HorseRacingPage.route(location.hash)};HorseRacingPage.initMenu=function(){NavigationBar.addNode({id:EventType.HORSE_RACING.value,type:"EVENT_TYPE",name:"Horse Racing"});NavigationHandler.getMenu([EventType.HORSE_RACING.value])};HorseRacingPage.route=function(c){if(c=="#Today"){TabMenuHandler.updateSelect("daySelectTab",c.substring(1).toLowerCase());HorseRacingPage.viewToday()}else{if(c=="#Tomorrow"){TabMenuHandler.updateSelect("daySelectTab",c.substring(1).toLowerCase());HorseRacingPage.viewTomorrow()}else{if(c=="#AftTomorrow"){TabMenuHandler.updateSelect("daySelectTab",c.substring(1).toLowerCase());HorseRacingPage.viewAftTomorrow()}else{JsCache.get("#loading").hide()}}}};HorseRacingPage.viewToday=function(){HorseRacingPage.tabChanged=true;HorseRacingPage.selectDayType="today";JsCache.get("#contentBox").children().remove();a("today")};HorseRacingPage.viewTomorrow=function(){HorseRacingPage.tabChanged=true;HorseRacingPage.selectDayType="tomorrow";JsCache.get("#contentBox").children().remove();a("tomorrow")};HorseRacingPage.viewAftTomorrow=function(){HorseRacingPage.tabChanged=true;HorseRacingPage.selectDayType="aftTomorrow";JsCache.get("#contentBox").children().remove();a("aftTomorrow")};HorseRacingPage.updateHorseRacingMarkets=null;HorseRacingPage.initUpdateHorseRacingMarkets=function(){HorseRacingPage.updateHorseRacingMarkets=TaskExecuter.createTask(PageConfig.updateHorseRacingMarketsCycleTime,2,function(){b(this)});HorseRacingPage.updateHorseRacingMarkets.run();TaskExecuter.execute()};function b(c){$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.queryRacingByDayPath,data:{dayType:HorseRacingPage.selectDayType,eventType:EventType.HORSE_RACING.value,marketTs:HorseRacingPage.marketTs},success:function(d){try{if(HorseRacingPage.tabChanged){HorseRacingPage.marketTs=-1;HorseRacingPage.tabChanged=false;return}if(d.marketTs>HorseRacingPage.marketTs){HorseRacingPage.marketTs=d.marketTs}if(d.events.length>0){RacingSportUtil.updateMarkets(d.events)}}catch(f){Trace.printStackTrace(f)}finally{c.check();TaskExecuter.execute()}},error:function(){c.check();TaskExecuter.execute()}})}})();