if(typeof(SportsBookMultiMarketHandler)=="undefined"){SportsBookMultiMarketHandler={}}(function(){SportsBookMultiMarketHandler.queryTasks=[];SportsBookMultiMarketHandler.init=function(a){if(ApiSiteType.SPORTRADAR.unique()==a&&SportsBookMultiMarketHandler.isEnableSportsBookBet()&&MultiMarketsHandler.isHasSportsBookMultiMarket()){SportsBookMultiMarketHandler.initTask(ApiSiteType.SPORTRADAR.unique())}if(ApiSiteType.OW.unique()==a&&SportsBookMultiMarketHandler.isEnableOwSportsBookBet()&&MultiMarketsHandler.isHasOwSportsBookMultiMarket()){SportsBookMultiMarketHandler.initTask(ApiSiteType.OW.unique())}};SportsBookMultiMarketHandler.initTask=function(b){if(SportsBookMultiMarketHandler.queryTasks[b]==null){var a=TaskExecuterV2.createTask(PageConfig.getSportsBookEventTaskCycleTime,0,function(){SportsBookMultiMarketHandler.querySportsBookMultiMarkets(this,b)});a.version={};a.oddsSettingVersion={};a.apiSiteType=b;SportsBookMultiMarketHandler.queryTasks[b]=a}else{SportsBookMultiMarketHandler.queryTasks[b].isStop=false}SportsBookMultiMarketHandler.queryTasks[b].run();TaskExecuterV2.execute()};SportsBookMultiMarketHandler.abortTask=function(a){if(SportsBookMultiMarketHandler.queryTasks[a]!=null){SportsBookMultiMarketHandler.queryTasks[a].stop()}};SportsBookMultiMarketHandler.isEnableSportsBookBet=function(){return AccountUtil.isEnableSportsBook(PageConfig.isAllowSportsbook,ApiSiteType.SPORTRADAR.unique())};SportsBookMultiMarketHandler.isEnableOwSportsBookBet=function(){return AccountUtil.isEnableSportsBook(PageConfig.isAllowSportsbook,ApiSiteType.OW.unique())};SportsBookMultiMarketHandler.querySportsBookMultiMarkets=function(d,c){var h=(ApiSiteType.SPORTRADAR.unique()==c)?CategoryType.SPORTRADAR_SPORTSBOOK.unique():CategoryType.OW_SPORTSBOOK.unique();var b=DataBase.multiMarkets.queryAllByCategoryType(h);var g=[];for(var e=0;e<b.length;e++){var a=b[e];var f={eventType:a.eventType,betfairEventId:a.eventId,marketId:a.marketId,selectionTs:-1,apiSiteType:c};g.push(f)}$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.landingPath+"/member/playerService/querySportsBookMultiMarkets",data:{marketPks:JSON.stringify(g)},success:function(l){try{if(!l){return}var k=l.sportsBookEvents;for(var m=0;m<k.length;m++){var j=k[m];SportsBookEventHandler.updateSportsBookEvent(c,j)}}catch(n){Trace.printStackTrace(n)}finally{d.check();TaskExecuterV2.execute()}},error:function(k,i,j){Trace.log(k.status);Trace.log(j);d.check();TaskExecuterV2V2.execute()}})}})();