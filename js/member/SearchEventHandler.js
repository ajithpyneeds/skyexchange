if(typeof(SearchEventHandler)=="undefined"){SearchEventHandler={}}(function(){var a=-1;SearchEventHandler.init=function(){var g=$j("#searchWrap");var i=g.find("#searchInput");var h=g.find("#searchClear");g.show();i.on("keyup",function(k){var j=k.which;if(KeyEventUtils.isArrowKey(j)||KeyEventUtils.isEnterKey(j)){return}SearchEventHandler.clearResult();SearchEventHandler.searchEvents()});i.on("keydown",function(k){var j=k.which;if(KeyEventUtils.isEnterKey(j)){d(k);return}if(!KeyEventUtils.isArrowKey(j)){return}f(k)});h.on("click",function(){i.val("");h.hide();SearchEventHandler.clearResult()})};SearchEventHandler.clearResult=function(){var g=$j("#searchWrap");var h=g.find("#searchList");h.find("#noMatching").hide();h.find("[id^=result_]").remove()};SearchEventHandler.searchEvents=function(){var h=$j("#searchWrap");var i=h.find("#searchInput");var g=i.val();if(g.length==0){return}h.find("#searchClear").show();$j.ajax({type:"POST",dataType:"JSON",url:PageConfig.landingPath+"/member/playerService/searchEvents",data:{keyword:g},success:function(j){try{if(!j||j.searchEvents==null||j.searchEvents.length==0){b();return}c(j.searchEvents)}catch(k){Trace.printStackTrace(k)}},error:function(l,j,k){Trace.log(l.status);Trace.log(k)}})};function b(){var g=$j("#searchWrap");var h=g.find("#searchList");h.find("#noMatching").fadeIn()}function c(j){a=-1;var o=$j("#searchWrap");var l=o.find("#searchResult");var k=l.find("#searchList");k.find("#noMatching").hide();l.fadeIn(function(){document.body.addEventListener("click",e,false)});for(var m in j){var g=j[m];if(g==null){continue}var p="result_"+g.eventId+"_"+g.marketId.replace(".","_");var n=k.find("#"+p);if(n.length>0){continue}var h=function(i,q,r){return function(){location.href=PageConfig.fullMarketPath+"?eventType="+i+"&eventId="+q+"&marketId="+r}}(g.eventType,g.eventId,g.marketId);n=k.find("#resultTemplate").clone();n.prop("id",p);n.find("a").html(g.marketTimeStr+" "+g.name);n.find("a").on("click",h);n.show();k.append(n)}}function e(g){document.body.removeEventListener("click",e,false);SearchEventHandler.clearResult()}function f(k){var h=$j("#searchWrap");var i=h.find("#searchList");var g=i.find("[id^=result_]:visible");if(g.length==0){return}var j=k.which;if(KeyEventUtils.isUpArrowKey(j)){if(a<=0){return}a--}if(KeyEventUtils.isDownArrowKey(j)){if(a>=g.length-1){return}a++}g.find("a").removeClass("hover");i.find(g[a]).find("a").addClass("hover")}function d(k){var i=$j("#searchWrap");var j=i.find("#searchList");var h=j.find("[id^=result_]:visible");if(h.length==0){return}var g=j.find(h[a]);if(g.length==0){return}g.find("a").click()}})();